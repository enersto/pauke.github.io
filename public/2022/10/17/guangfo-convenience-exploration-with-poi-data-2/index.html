<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.104.3" />


<title>POI数据的分析与展示 - IFF</title>
<meta property="og:title" content="POI数据的分析与展示 - IFF">


  <link href='/favicon.ico' rel='icon' type='image/x-icon'/>



  
  <meta property="description" content="广佛生活便利程度街镇分布情况探微（二）">
  








<link href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="/" class="nav-logo">
    <img src="/images/logo.png"
         width="120"
         height="90"
         alt="Logo">
  </a>

  <ul class="nav-links">
    
    <li><a href="/about/">About</a></li>
    
    <li><a href="/">Home</a></li>
    
    <li><a href="/tags/">Tag</a></li>
    
    <li><a href="https://t.me/quatsch_von_h">Telegram</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">10 min read</span>
    

    <h1 class="article-title">POI数据的分析与展示</h1>
    <h2>广佛生活便利程度街镇分布情况探微（二）</h2>

    
    <span class="article-date">2022-10-17 · 4560 words · </span>
    

    <div class="article-content">
      

<div id="TOC">
<ul>
<li><a href="#商场" id="toc-商场">商场</a>
<ul>
<li><a href="#分类整理" id="toc-分类整理">分类整理</a></li>
<li><a href="#商场全类" id="toc-商场全类">商场全类</a></li>
<li><a href="#购物中心" id="toc-购物中心">购物中心</a></li>
</ul></li>
<li><a href="#银行" id="toc-银行">银行</a>
<ul>
<li><a href="#全域" id="toc-全域">全域</a></li>
<li><a href="#核心区" id="toc-核心区">核心区</a></li>
</ul></li>
<li><a href="#公园" id="toc-公园">公园</a>
<ul>
<li><a href="#全域-1" id="toc-全域-1">全域</a></li>
<li><a href="#核心区-1" id="toc-核心区-1">核心区</a></li>
</ul></li>
<li><a href="#医院" id="toc-医院">医院</a>
<ul>
<li><a href="#整体医疗设施分布" id="toc-整体医疗设施分布">整体医疗设施分布</a></li>
<li><a href="#三甲医院分布" id="toc-三甲医院分布">三甲医院分布</a></li>
</ul></li>
<li><a href="#教育" id="toc-教育">教育</a>
<ul>
<li><a href="#分类整理-1" id="toc-分类整理-1">分类整理</a></li>
<li><a href="#全域-2" id="toc-全域-2">全域</a></li>
<li><a href="#核心区-2" id="toc-核心区-2">核心区</a></li>
</ul></li>
<li><a href="#政府服务机构" id="toc-政府服务机构">政府服务机构</a>
<ul>
<li><a href="#筛选" id="toc-筛选">筛选</a></li>
<li><a href="#全域-3" id="toc-全域-3">全域</a></li>
<li><a href="#核心区-3" id="toc-核心区-3">核心区</a></li>
</ul></li>
<li><a href="#餐饮" id="toc-餐饮">餐饮</a></li>
<li><a href="#未完待续" id="toc-未完待续">未完待续</a></li>
</ul>
</div>

<p>本文依赖的包：</p>
<pre class="r"><code>library(knitr)
library(ggplot2)
library(data.table)
library(sf)
library(openxlsx)
library(dplyr)
library(RColorBrewer)
library(DescTools)
library(leaflet)
library(sp)

options(scipen=8)</code></pre>
<p>书接<a href="https://pauke.netlify.app/2022/10/14/guangfo-convenience-exploration-with-poi-data/">上回</a>，这篇文章会进一步展开讨论其余部分的poi数据。</p>
<div id="商场" class="section level3">
<h3>商场</h3>
<p>商场部分经过前期的数据探查，不同街镇间相对合理，抽查部分点位后也与实际相仿，具有进一步实际探查的意义。</p>
<pre class="r"><code>poi_ml &lt;- st_transform(poi_ml,4326)
poi_ml_fs &lt;- st_transform(poi_ml_fs,4326)

poi_ml &lt;- rbind(poi_ml[,c(&quot;cityname&quot;,&quot;lat&quot;,&quot;lon&quot;,&quot;name&quot;, &quot;address&quot; ,&quot;type1&quot;,&quot;type2&quot;,&quot;type3&quot;,&quot;geometry&quot;)],
                poi_ml_fs[,c(&quot;cityname&quot;,&quot;lat&quot;,&quot;lon&quot;,&quot;name&quot;, &quot;address&quot; ,&quot;type1&quot;,&quot;type2&quot;,&quot;type3&quot;,&quot;geometry&quot;)])
poi_ml &lt;- unique(poi_ml)
knitr::kable(head(Desc(poi_ml$type2)[[1]][[&quot;freq&quot;]],15))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">level</th>
<th align="right">freq</th>
<th align="right">perc</th>
<th align="right">cumfreq</th>
<th align="right">cumperc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">商场</td>
<td align="right">1703</td>
<td align="right">0.7629928</td>
<td align="right">1703</td>
<td align="right">0.7629928</td>
</tr>
<tr class="even">
<td align="left">购物相关场所</td>
<td align="right">209</td>
<td align="right">0.0936380</td>
<td align="right">1912</td>
<td align="right">0.8566308</td>
</tr>
<tr class="odd">
<td align="left">便民商店/便利店</td>
<td align="right">92</td>
<td align="right">0.0412186</td>
<td align="right">2004</td>
<td align="right">0.8978495</td>
</tr>
<tr class="even">
<td align="left">楼宇</td>
<td align="right">70</td>
<td align="right">0.0313620</td>
<td align="right">2074</td>
<td align="right">0.9292115</td>
</tr>
<tr class="odd">
<td align="left">超级市场</td>
<td align="right">64</td>
<td align="right">0.0286738</td>
<td align="right">2138</td>
<td align="right">0.9578853</td>
</tr>
<tr class="even">
<td align="left">专卖店</td>
<td align="right">16</td>
<td align="right">0.0071685</td>
<td align="right">2154</td>
<td align="right">0.9650538</td>
</tr>
<tr class="odd">
<td align="left">商务住宅相关</td>
<td align="right">16</td>
<td align="right">0.0071685</td>
<td align="right">2170</td>
<td align="right">0.9722222</td>
</tr>
<tr class="even">
<td align="left">综合市场</td>
<td align="right">16</td>
<td align="right">0.0071685</td>
<td align="right">2186</td>
<td align="right">0.9793907</td>
</tr>
<tr class="odd">
<td align="left">服装鞋帽皮具店</td>
<td align="right">12</td>
<td align="right">0.0053763</td>
<td align="right">2198</td>
<td align="right">0.9847670</td>
</tr>
<tr class="even">
<td align="left">家电电子卖场</td>
<td align="right">9</td>
<td align="right">0.0040323</td>
<td align="right">2207</td>
<td align="right">0.9887993</td>
</tr>
<tr class="odd">
<td align="left">门牌信息</td>
<td align="right">6</td>
<td align="right">0.0026882</td>
<td align="right">2213</td>
<td align="right">0.9914875</td>
</tr>
<tr class="even">
<td align="left">家居建材市场</td>
<td align="right">5</td>
<td align="right">0.0022401</td>
<td align="right">2218</td>
<td align="right">0.9937276</td>
</tr>
<tr class="odd">
<td align="left">产业园区</td>
<td align="right">3</td>
<td align="right">0.0013441</td>
<td align="right">2221</td>
<td align="right">0.9950717</td>
</tr>
<tr class="even">
<td align="left">住宅区</td>
<td align="right">1</td>
<td align="right">0.0004480</td>
<td align="right">2222</td>
<td align="right">0.9955197</td>
</tr>
<tr class="odd">
<td align="left">体育休闲服务场所</td>
<td align="right">1</td>
<td align="right">0.0004480</td>
<td align="right">2223</td>
<td align="right">0.9959677</td>
</tr>
</tbody>
</table>
<p>进一步探查分类情况，该类数据分类中虽然有「购物相关场所」,「楼宇」,「商务住宅相关」等之类的分类，但也都是商场类别数据，这种分类方式存在一定的重叠和矛盾之处，不如先全部统一为商场一个分类。同时，诸如万达、正佳之类的商场与其余较小的商场有较大区别，有必要与其他商场做一个区分。根据连锁经营协会的<a href="http://www.ccfa.org.cn/portal/cn/xiangxi.jsp?type=10003&amp;id=442698">TOP60购物中心</a>数据，筛选并名列出其中的购物中心的部分。</p>
<div id="分类整理" class="section level4">
<h4>分类整理</h4>
<pre class="r"><code>insc_ml &lt;- st_join(gz_t[,c(&quot;Name&quot;,&quot;layer1&quot;,&quot;layer2&quot;,&quot;geometry&quot;)],poi_ml)
insc_ml &lt;- setDT(insc_ml)[,cate:= type2 ]

##冗余或错误分类，均归为商场一类

insc_ml &lt;- insc_ml[type2 %in% c(&quot;购物相关场所&quot;,&quot;楼宇&quot;,&quot;商务住宅相关&quot;,&quot;便民商店/便利店&quot;,&quot;超级市场&quot;,
                                &quot;专卖店&quot;,&quot;综合市场&quot;,&quot;服装鞋帽皮具店&quot;,&quot;家电电子卖场&quot;,
                                &quot;家居建材市场&quot;) ,cate:= &quot;商场&quot;]


##根据原有分类和实际情况下的购物中心信息区分出购物中心分类

pat &lt;- &quot;万达广场|吾悦广场|世纪金源购物中心|方圆荟|印象城|印象汇|印象里|印象城MEG|宝龙一城|宝龙城|宝龙广场|宝龙天地|天街|星悦荟|家悦荟|万象城|万象汇|万象天地|五彩城|凯德MALL|来福士|凯德广场|金地广场|金地中心|银泰城|银泰in|银泰荟|金鹰购物中心|苏宁广场|王府井购物中心|王府井奥莱|天虹购物中心|爱琴海|百联购物中心|百联奥特莱斯|银泰百货|保利广场|BHGMALL|蛇口花园城|海上世界|九方|融创文旅城|COCOPark|COCOCity|iCO|COCOGarden|永旺梦乐城|步步高新天地|步步高广场|世茂广场|益田假日|中南城|大悦城|大悦春风里|祥云小镇|八佰伴购物中心|UNIC环宇系购物中心|砂之船奥莱|首创奥特莱斯|新天地|佳兆业|佳纷天地|中骏世界城|APM|环贸广场|天环|天汇广场|览秀城|J·LIFE|金茂汇|万科广场|大融城|禹洲广场|禹悦里|环球港|合生汇|合生广场|合生新天地|武商广场|富力广场|富力城|远洋未来广场|远洋未来汇|恒隆广场|杉杉奥莱|IFS国金中心|东百中心|鲁能城|鲁能美丽汇|悠方|魔方|悠方天地|旭辉广场|旭辉里|SM广场|中环购物中心|佛罗伦萨小镇|嘉里中心|弘阳广场|荟聚|太古里|太古汇|颐堤港&quot;
insc_ml &lt;- insc_ml[grep(pat,name, perl = TRUE) ,cate:= &quot;购物中心&quot;][type3 %in% c(&quot;购物中心&quot;),cate:= &quot;购物中心&quot;]

knitr::kable(head(Desc(insc_ml$cate)[[1]][[&quot;freq&quot;]],15))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">level</th>
<th align="right">freq</th>
<th align="right">perc</th>
<th align="right">cumfreq</th>
<th align="right">cumperc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">商场</td>
<td align="right">1787</td>
<td align="right">0.8006272</td>
<td align="right">1787</td>
<td align="right">0.8006272</td>
</tr>
<tr class="even">
<td align="left">购物中心</td>
<td align="right">427</td>
<td align="right">0.1913082</td>
<td align="right">2214</td>
<td align="right">0.9919355</td>
</tr>
<tr class="odd">
<td align="left">门牌信息</td>
<td align="right">5</td>
<td align="right">0.0022401</td>
<td align="right">2219</td>
<td align="right">0.9941756</td>
</tr>
<tr class="even">
<td align="left">产业园区</td>
<td align="right">3</td>
<td align="right">0.0013441</td>
<td align="right">2222</td>
<td align="right">0.9955197</td>
</tr>
<tr class="odd">
<td align="left">住宅区</td>
<td align="right">1</td>
<td align="right">0.0004480</td>
<td align="right">2223</td>
<td align="right">0.9959677</td>
</tr>
<tr class="even">
<td align="left">体育用品店</td>
<td align="right">1</td>
<td align="right">0.0004480</td>
<td align="right">2224</td>
<td align="right">0.9964158</td>
</tr>
<tr class="odd">
<td align="left">公司</td>
<td align="right">1</td>
<td align="right">0.0004480</td>
<td align="right">2225</td>
<td align="right">0.9968638</td>
</tr>
<tr class="even">
<td align="left">公司企业</td>
<td align="right">1</td>
<td align="right">0.0004480</td>
<td align="right">2226</td>
<td align="right">0.9973118</td>
</tr>
<tr class="odd">
<td align="left">公园广场</td>
<td align="right">1</td>
<td align="right">0.0004480</td>
<td align="right">2227</td>
<td align="right">0.9977599</td>
</tr>
<tr class="even">
<td align="left">旅馆招待所</td>
<td align="right">1</td>
<td align="right">0.0004480</td>
<td align="right">2228</td>
<td align="right">0.9982079</td>
</tr>
<tr class="odd">
<td align="left">汽车服务相关</td>
<td align="right">1</td>
<td align="right">0.0004480</td>
<td align="right">2229</td>
<td align="right">0.9986559</td>
</tr>
<tr class="even">
<td align="left">特色商业街</td>
<td align="right">1</td>
<td align="right">0.0004480</td>
<td align="right">2230</td>
<td align="right">0.9991039</td>
</tr>
<tr class="odd">
<td align="left">美容美发店</td>
<td align="right">1</td>
<td align="right">0.0004480</td>
<td align="right">2231</td>
<td align="right">0.9995520</td>
</tr>
<tr class="even">
<td align="left">风景名胜相关</td>
<td align="right">1</td>
<td align="right">0.0004480</td>
<td align="right">2232</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
<p>整理后的数据也是采取与超市部分类似的方式，只取其中的TOP 99%的两类数据：</p>
<pre class="r"><code>category &lt;- head(Desc(insc_ml$cate)[[1]][[&quot;freq&quot;]],2)$level
insc_ml_ag &lt;- insc_ml[!is.na(name),][cate %in% category][,.(cnt= length(name)),by = c(&quot;Name&quot;,&quot;layer1&quot;,&quot;cate&quot;)]
insc_ml_ag_1 &lt;- insc_ml_ag[,.(cnt= sum(cnt)),by = c(&quot;Name&quot;)]</code></pre>
</div>
<div id="商场全类" class="section level4">
<h4>商场全类</h4>
<p>首先是广佛全域的整体商场类设施的万人密度情况：</p>
<pre class="r"><code>gz_t_ml_1 &lt;- left_join(gz_t,insc_ml_ag_1,by =c(&quot;Name&quot;))
gz_t_ml_2 &lt;- setDT(gz_t_ml_1)[,pre_cnt := cnt/n7th*10000]
gz_t_ml_2 &lt;- st_as_sf(gz_t_ml_2)


ggplot()+ geom_sf(data = gz_t_ml_2,aes(fill= pre_cnt,geometry = geometry))+
  scale_fill_distiller(palette=&#39;Spectral&#39;)+
  geom_sf_text(data = gz_t_ml_2[gz_t_ml_2$pre_cnt &gt;= 3,],aes(label = Name),
               family=&#39;Songti SC&#39;,size = 3,color = &quot;ghostwhite&quot;)+
  theme(text = element_text(family=&#39;Songti SC&#39;),         
        axis.title.x=element_blank(),          
        axis.title.y=element_blank())</code></pre>
<p><img src="/2022/10/17/guangfo-convenience-exploration-with-poi-data-2/index_files/figure-html/ml_tt-1.png" width="1000" />
- 除了越秀、天河这类核心区的超高密度外，连片建成区的街乡也想对有一定的分布。</p>
</div>
<div id="购物中心" class="section level4">
<h4>购物中心</h4>
<p>购物中心有高度的城市密集区依赖的属性，故而部分集中展示核心区的购物中心密度情况：</p>
<pre class="r"><code>gz_t_ml_1 &lt;- left_join(gz_t,insc_ml_ag[cate == &quot;购物中心&quot;,],by =c(&quot;Name&quot;))
gz_t_ml_2 &lt;- setDT(gz_t_ml_1)[,pre_cnt := cnt/n7th*10000]
gz_t_ml_2 &lt;- st_as_sf(gz_t_ml_2)


ggplot()+ geom_sf(data = gz_t_ml_2[gz_t_ml_2$core== T,],aes(fill= pre_cnt,geometry = geometry))+
  scale_fill_distiller(palette=&#39;Spectral&#39;)+
  geom_sf_text(data = gz_t_ml_2[gz_t_ml_2$pre_cnt &gt;= 1,],aes(label = Name),
               family=&#39;Songti SC&#39;,size = 3)+
  theme(text = element_text(family=&#39;Songti SC&#39;),         
        axis.title.x=element_blank(),          
        axis.title.y=element_blank())</code></pre>
<p><img src="/2022/10/17/guangfo-convenience-exploration-with-poi-data-2/index_files/figure-html/ml_fc-1.png" width="1000" /></p>
<ul>
<li>广州中心部分表现出部分街道有较高密度的购物中心，有的街道则一个都没有，番禺、佛山则相对较为平均的每个街乡保持0.5个/万人的分布密度。</li>
</ul>
</div>
</div>
<div id="银行" class="section level3">
<h3>银行</h3>
<p>从银行poi的数据探查来看：</p>
<ul>
<li>该类数据类别相对集中，且分类没有显著意义区分故不做更多清洗和分类</li>
</ul>
<pre class="r"><code>poi_bk &lt;- st_transform(poi_bk,4326)
poi_bk_fs &lt;- st_transform(poi_bk_fs,4326)

poi_bk &lt;- rbind(poi_bk[,c(&quot;cityname&quot;,&quot;lat&quot;,&quot;lon&quot;,&quot;name&quot;, &quot;address&quot; ,&quot;type1&quot;,&quot;type2&quot;,&quot;type3&quot;,&quot;geometry&quot;)],
                poi_bk_fs[,c(&quot;cityname&quot;,&quot;lat&quot;,&quot;lon&quot;,&quot;name&quot;, &quot;address&quot; ,&quot;type1&quot;,&quot;type2&quot;,&quot;type3&quot;,&quot;geometry&quot;)])
poi_bk &lt;- unique(poi_bk)
knitr::kable(head(Desc(poi_bk$type2)[[1]][[&quot;freq&quot;]],15))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">level</th>
<th align="right">freq</th>
<th align="right">perc</th>
<th align="right">cumfreq</th>
<th align="right">cumperc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">自动提款机</td>
<td align="right">4742</td>
<td align="right">0.5163328</td>
<td align="right">4742</td>
<td align="right">0.5163328</td>
</tr>
<tr class="even">
<td align="left">银行</td>
<td align="right">4439</td>
<td align="right">0.4833406</td>
<td align="right">9181</td>
<td align="right">0.9996733</td>
</tr>
<tr class="odd">
<td align="left">银行相关</td>
<td align="right">2</td>
<td align="right">0.0002178</td>
<td align="right">9183</td>
<td align="right">0.9998911</td>
</tr>
<tr class="even">
<td align="left">邮局</td>
<td align="right">1</td>
<td align="right">0.0001089</td>
<td align="right">9184</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
<ul>
<li>该类数据在各个街镇间的分布与实际相符</li>
</ul>
<pre class="r"><code>ggplot()+ geom_sf(data = gz_t,aes(geometry = geometry))+
  geom_sf(data = poi_bk,aes(geometry = geometry),size = 0.5, color = &quot;red&quot;)</code></pre>
<p><img src="/2022/10/17/guangfo-convenience-exploration-with-poi-data-2/index_files/figure-html/bk_pre-1.png" width="1000" /></p>
<div id="全域" class="section level4">
<h4>全域</h4>
<p>所以，可以直接先来列示广佛全域的银行类设施的万人密度图：</p>
<pre class="r"><code>insc_bk &lt;- st_join(gz_t[,c(&quot;Name&quot;,&quot;layer1&quot;,&quot;layer2&quot;,&quot;geometry&quot;)],poi_bk)
insc_bk_ag &lt;- setDT(insc_bk)[!is.na(name),][,.(cnt= length(name)),by = c(&quot;Name&quot;,&quot;layer1&quot;,&quot;layer2&quot;,&quot;type1&quot;,&quot;type2&quot;,&quot;type3&quot;)]
insc_bk_ag_1 &lt;- insc_bk_ag[,.(cnt= sum(cnt)),by = c(&quot;Name&quot;)]

gz_t_bk_1 &lt;- left_join(gz_t,insc_bk_ag_1,by =c(&quot;Name&quot;))
gz_t_bk_2 &lt;- setDT(gz_t_bk_1)[,pre_cnt := cnt/n7th*10000]
gz_t_bk_2 &lt;- st_as_sf(gz_t_bk_2)

ggplot()+ geom_sf(data = gz_t_bk_2,aes(fill= pre_cnt,geometry = geometry))+
  scale_fill_distiller(palette=&#39;Spectral&#39;)+
  theme(text = element_text(family=&#39;Songti SC&#39;),         
        axis.title.x=element_blank(),          
        axis.title.y=element_blank())</code></pre>
<p><img src="/2022/10/17/guangfo-convenience-exploration-with-poi-data-2/index_files/figure-html/bk_tt-1.png" width="1000" /></p>
<ul>
<li>高密度的街道基本集中在珠江新城为核心的广州CBD区域，其余街镇则相对均值。</li>
</ul>
</div>
<div id="核心区" class="section level4">
<h4>核心区</h4>
<p>以及核心区域的万人密度情况：</p>
<pre class="r"><code>ggplot()+ geom_sf(data = gz_t_bk_2[gz_t_bk_2$core== T,],aes(fill= pre_cnt,geometry = geometry))+
  scale_fill_distiller(palette=&#39;Spectral&#39;)+
  geom_sf_text(data = gz_t_bk_2[gz_t_bk_2$pre_cnt &gt;= 10,],aes(label = Name),
               family=&#39;Songti SC&#39;,size = 3)+
  theme(text = element_text(family=&#39;Songti SC&#39;),         
        axis.title.x=element_blank(),          
        axis.title.y=element_blank())</code></pre>
<p><img src="/2022/10/17/guangfo-convenience-exploration-with-poi-data-2/index_files/figure-html/bk_fc-1.png" width="1000" />
- 趋势与全域图一致，但可以更清晰看出越秀和天河的集中情况</p>
</div>
</div>
<div id="公园" class="section level3">
<h3>公园</h3>
<p>公园部分数据分为了公园广场和风景名胜两个大类，数据较为均值，同时，两类在本系列文章的主旨下，区分的意义不大，故不作进一步处理和分类。</p>
<pre class="r"><code>poi_pk &lt;- st_transform(poi_pk,4326)
poi_pk_fs &lt;- st_transform(poi_pk_fs,4326)

poi_pk &lt;- rbind(poi_pk[,c(&quot;cityname&quot;,&quot;lat&quot;,&quot;lon&quot;,&quot;name&quot;, &quot;address&quot; ,&quot;type1&quot;,&quot;type2&quot;,&quot;type3&quot;,&quot;geometry&quot;)],
                poi_pk_fs[,c(&quot;cityname&quot;,&quot;lat&quot;,&quot;lon&quot;,&quot;name&quot;, &quot;address&quot; ,&quot;type1&quot;,&quot;type2&quot;,&quot;type3&quot;,&quot;geometry&quot;)])
poi_pk &lt;- unique(poi_pk)
knitr::kable(head(Desc(poi_pk$type2)[[1]][[&quot;freq&quot;]],15))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">level</th>
<th align="right">freq</th>
<th align="right">perc</th>
<th align="right">cumfreq</th>
<th align="right">cumperc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">公园广场</td>
<td align="right">1210</td>
<td align="right">0.9002976</td>
<td align="right">1210</td>
<td align="right">0.9002976</td>
</tr>
<tr class="even">
<td align="left">风景名胜</td>
<td align="right">82</td>
<td align="right">0.0610119</td>
<td align="right">1292</td>
<td align="right">0.9613095</td>
</tr>
<tr class="odd">
<td align="left">风景名胜相关</td>
<td align="right">52</td>
<td align="right">0.0386905</td>
<td align="right">1344</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
<div id="全域-1" class="section level4">
<h4>全域</h4>
<p>广佛全域公园类设施的街镇分布情况：</p>
<pre class="r"><code>insc_pk &lt;- st_join(gz_t[,c(&quot;Name&quot;,&quot;layer1&quot;,&quot;layer2&quot;,&quot;geometry&quot;)],poi_pk)
insc_pk_ag &lt;- setDT(insc_pk)[!is.na(name),][,.(cnt= length(name)),by = c(&quot;Name&quot;,&quot;layer1&quot;,&quot;layer2&quot;,&quot;type1&quot;,&quot;type2&quot;,&quot;type3&quot;)]
insc_pk_ag_1 &lt;- insc_pk_ag[type2== &quot;公园广场&quot;,][,.(cnt= sum(cnt)),by = c(&quot;Name&quot;)]

gz_t_pk_1 &lt;- left_join(gz_t,insc_pk_ag_1,by =c(&quot;Name&quot;))
gz_t_pk_2 &lt;- setDT(gz_t_pk_1)[,pre_cnt := cnt/n7th*10000]
gz_t_pk_2 &lt;- st_as_sf(gz_t_pk_2)

ggplot()+ geom_sf(data = gz_t_pk_2,aes(fill= pre_cnt,geometry = geometry))+
  scale_fill_distiller(palette=&#39;Spectral&#39;)+
  geom_sf_text(data = gz_t_pk_2[gz_t_pk_2$pre_cnt &gt;= 1.5,],aes(label = Name),
               family=&#39;Songti SC&#39;,size = 2.5)+
  theme(text = element_text(family=&#39;Songti SC&#39;),         
        axis.title.x=element_blank(),          
        axis.title.y=element_blank())</code></pre>
<p><img src="/2022/10/17/guangfo-convenience-exploration-with-poi-data-2/index_files/figure-html/pk_data_format-1.png" width="1000" /></p>
<ul>
<li>公园类设施具有显著的非城市中心的属性，高人均的多以城郊乡镇为主</li>
</ul>
</div>
<div id="核心区-1" class="section level4">
<h4>核心区</h4>
<p>核心城区的公园类设施的分布情况：</p>
<pre class="r"><code>ggplot()+ geom_sf(data = gz_t_pk_2[gz_t_pk_2$core== T,],aes(fill= pre_cnt,geometry = geometry))+
  scale_fill_distiller(palette=&#39;Spectral&#39;)+
  geom_sf_text(data = gz_t_pk_2[gz_t_pk_2$core== T &amp; gz_t_pk_2$pre_cnt &gt;= 1,],aes(label = Name),
               family=&#39;Songti SC&#39;,size = 3)+
  theme(text = element_text(family=&#39;Songti SC&#39;),         
        axis.title.x=element_blank(),          
        axis.title.y=element_blank())</code></pre>
<p><img src="/2022/10/17/guangfo-convenience-exploration-with-poi-data-2/index_files/figure-html/pk_fc-1.png" width="1000" /></p>
</div>
</div>
<div id="医院" class="section level3">
<h3>医院</h3>
<p>从二级分类来看，与前面两类类似，医院部分的数据同样表现出分类均质化程度高和分类上不具有进一步分类的意义的特征。在三级分类中，还做了三甲的一类分类，但因为该类数据量仅有75个，缺乏在分析意义的单独分类，故不会做进一步区分，但会在后面单独筛选列示以作参考。</p>
<pre class="r"><code>poi_hp &lt;- st_transform(poi_hp,4326)
poi_hp_fs &lt;- st_transform(poi_hp_fs,4326)

poi_hp &lt;- rbind(poi_hp[,c(&quot;cityname&quot;,&quot;lat&quot;,&quot;lon&quot;,&quot;name&quot;, &quot;address&quot; ,&quot;type1&quot;,&quot;type2&quot;,&quot;type3&quot;,&quot;geometry&quot;)],
                poi_hp_fs[,c(&quot;cityname&quot;,&quot;lat&quot;,&quot;lon&quot;,&quot;name&quot;, &quot;address&quot; ,&quot;type1&quot;,&quot;type2&quot;,&quot;type3&quot;,&quot;geometry&quot;)])
poi_hp &lt;- unique(poi_hp)
knitr::kable(head(Desc(poi_hp$type2)[[1]][[&quot;freq&quot;]],15))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">level</th>
<th align="right">freq</th>
<th align="right">perc</th>
<th align="right">cumfreq</th>
<th align="right">cumperc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">综合医院</td>
<td align="right">1190</td>
<td align="right">0.9260700</td>
<td align="right">1190</td>
<td align="right">0.9260700</td>
</tr>
<tr class="even">
<td align="left">医疗保健服务场所</td>
<td align="right">60</td>
<td align="right">0.0466926</td>
<td align="right">1250</td>
<td align="right">0.9727626</td>
</tr>
<tr class="odd">
<td align="left">专科医院</td>
<td align="right">27</td>
<td align="right">0.0210117</td>
<td align="right">1277</td>
<td align="right">0.9937743</td>
</tr>
<tr class="even">
<td align="left">诊所</td>
<td align="right">6</td>
<td align="right">0.0046693</td>
<td align="right">1283</td>
<td align="right">0.9984436</td>
</tr>
<tr class="odd">
<td align="left">医药保健销售店</td>
<td align="right">2</td>
<td align="right">0.0015564</td>
<td align="right">1285</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
<div id="整体医疗设施分布" class="section level4">
<h4>整体医疗设施分布</h4>
<p>广佛全域医疗类设施的街镇分布情况：</p>
<pre class="r"><code>insc_hp &lt;- st_join(gz_t[,c(&quot;Name&quot;,&quot;layer1&quot;,&quot;layer2&quot;,&quot;geometry&quot;)],poi_hp)
insc_hp_ag &lt;- setDT(insc_hp)[!is.na(name),][,.(cnt= length(name)),by = c(&quot;Name&quot;,&quot;layer1&quot;,&quot;layer2&quot;,&quot;type1&quot;,&quot;type2&quot;,&quot;type3&quot;)]
insc_hp_ag_1 &lt;- insc_hp_ag[,.(cnt= sum(cnt)),by = c(&quot;Name&quot;)]

gz_t_hp_1 &lt;- left_join(gz_t,insc_hp_ag_1,by =c(&quot;Name&quot;))
gz_t_hp_2 &lt;- setDT(gz_t_hp_1)[,pre_cnt := cnt/n7th*10000]
gz_t_hp_2 &lt;- st_as_sf(gz_t_hp_2)

ggplot()+ geom_sf(data = gz_t_hp_2,aes(fill= pre_cnt,geometry = geometry))+
  scale_fill_distiller(palette=&#39;Spectral&#39;)+
  geom_sf_text(data = gz_t_hp_2[gz_t_hp_2$pre_cnt &gt;= 1.5,],aes(label = Name),
               family=&#39;Songti SC&#39;,size = 2.5)+
  theme(text = element_text(family=&#39;Songti SC&#39;),         
        axis.title.x=element_blank(),          
        axis.title.y=element_blank())</code></pre>
<p><img src="/2022/10/17/guangfo-convenience-exploration-with-poi-data-2/index_files/figure-html/hp_data_format-1.png" width="1000" />
- 除了越秀、荔湾核心区集中的公共设施普遍趋势外，部分外周乡镇凭借较低的人口基数，均摊获得了较高的万人医疗设施数量；
- 广州城郊部分的医疗设施密度，与佛山相比有显著性的差异，特别是白云、花都更是形成塌陷区。</p>
</div>
<div id="三甲医院分布" class="section level4">
<h4>三甲医院分布</h4>
<p>虽然在外周乡镇有分布，三甲医院仍然高度集中在核心区域，故列示只做核心区域的分布情况：</p>
<pre class="r"><code>insc_hp_ag_2 &lt;- insc_hp_ag[type3== &quot;三级甲等医院&quot;,][,.(cnt= sum(cnt)),by = c(&quot;Name&quot;)]

gz_t_hp_1 &lt;- left_join(gz_t,insc_hp_ag_2,by =c(&quot;Name&quot;))
gz_t_hp_2 &lt;- setDT(gz_t_hp_1)[,pre_cnt := cnt/n7th*10000]
gz_t_hp_2 &lt;- st_as_sf(gz_t_hp_2)

ggplot()+ geom_sf(data = gz_t_hp_2[gz_t_hp_2$core== T,],aes(fill= pre_cnt,geometry = geometry))+
  scale_fill_distiller(palette=&#39;Spectral&#39;)+
  geom_sf_text(data = gz_t_hp_2[gz_t_hp_2$core== T &amp; gz_t_hp_2$pre_cnt &gt;= 0.3,],aes(label = Name),
               family=&#39;Songti SC&#39;,size = 2.5)+
  theme(text = element_text(family=&#39;Songti SC&#39;),         
        axis.title.x=element_blank(),          
        axis.title.y=element_blank())</code></pre>
<p><img src="/2022/10/17/guangfo-convenience-exploration-with-poi-data-2/index_files/figure-html/hp_fc-1.png" width="1000" /></p>
<ul>
<li>越秀、天河和荔湾仍然是三甲医院高密度街道的集中地</li>
</ul>
</div>
</div>
<div id="教育" class="section level3">
<h3>教育</h3>
<p>教育部分数据在街乡间的分布符合实际且无异常。</p>
<pre class="r"><code>poi_ed &lt;- st_transform(poi_ed,4326)
poi_ed_fs &lt;- st_transform(poi_ed_fs,4326)

poi_ed &lt;- rbind(poi_ed[,c(&quot;cityname&quot;,&quot;lat&quot;,&quot;lon&quot;,&quot;name&quot;, &quot;address&quot; ,&quot;type1&quot;,&quot;type2&quot;,&quot;type3&quot;,&quot;geometry&quot;)],
                poi_ed_fs[,c(&quot;cityname&quot;,&quot;lat&quot;,&quot;lon&quot;,&quot;name&quot;, &quot;address&quot; ,&quot;type1&quot;,&quot;type2&quot;,&quot;type3&quot;,&quot;geometry&quot;)])
poi_ed &lt;- unique(poi_ed)

knitr::kable(head(Desc(poi_ed$type2)[[1]][[&quot;freq&quot;]],15))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">level</th>
<th align="right">freq</th>
<th align="right">perc</th>
<th align="right">cumfreq</th>
<th align="right">cumperc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">学校</td>
<td align="right">4479</td>
<td align="right">0.8337677</td>
<td align="right">4479</td>
<td align="right">0.8337677</td>
</tr>
<tr class="even">
<td align="left">科教文化场所</td>
<td align="right">881</td>
<td align="right">0.1639985</td>
<td align="right">5360</td>
<td align="right">0.9977662</td>
</tr>
<tr class="odd">
<td align="left">培训机构</td>
<td align="right">7</td>
<td align="right">0.0013031</td>
<td align="right">5367</td>
<td align="right">0.9990692</td>
</tr>
<tr class="even">
<td align="left">公检法机构</td>
<td align="right">1</td>
<td align="right">0.0001862</td>
<td align="right">5368</td>
<td align="right">0.9992554</td>
</tr>
<tr class="odd">
<td align="left">科研机构</td>
<td align="right">1</td>
<td align="right">0.0001862</td>
<td align="right">5369</td>
<td align="right">0.9994415</td>
</tr>
<tr class="even">
<td align="left">运动场馆</td>
<td align="right">1</td>
<td align="right">0.0001862</td>
<td align="right">5370</td>
<td align="right">0.9996277</td>
</tr>
<tr class="odd">
<td align="left">风景名胜</td>
<td align="right">1</td>
<td align="right">0.0001862</td>
<td align="right">5371</td>
<td align="right">0.9998138</td>
</tr>
<tr class="even">
<td align="left">高尔夫相关</td>
<td align="right">1</td>
<td align="right">0.0001862</td>
<td align="right">5372</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
<div id="分类整理-1" class="section level4">
<h4>分类整理</h4>
<p>基于前期探查，教育部分的数据会做以下几类处理：</p>
<ul>
<li>区分出大学和中小学，大学不具有街道乡镇层级在地服务属性，故不会纳入本系列的密度情况计算；</li>
<li>二级分类中的「科教文化场所」芜杂的掺入了培训学校、中高职、党校和大学等类型设施，与本系列的主旨并不相符，故该类数据也不纳入密度计算；</li>
</ul>
<pre class="r"><code>insc_ed &lt;- st_join(gz_t[,c(&quot;Name&quot;,&quot;layer1&quot;,&quot;layer2&quot;,&quot;geometry&quot;)],poi_ed)
insc_ed &lt;- setDT(insc_ed)[,cate:= type2 ]

##提取出中小学相关数据

pat &lt;- &quot;中学|小学|附|外国|初中|高中&quot;
  insc_ed &lt;- insc_ed[type3 %in% c(&quot;中学&quot;,&quot;小学&quot;,&quot;中学|科教文化服务&quot;,&quot;小学|科教文化服务&quot;) ,
                     cate:= &quot;中小学&quot;][grep(pat,name, perl = TRUE) ,cate:= &quot;中小学&quot;]


knitr::kable(head(Desc(insc_ed$cate)[[1]][[&quot;freq&quot;]],15))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">level</th>
<th align="right">freq</th>
<th align="right">perc</th>
<th align="right">cumfreq</th>
<th align="right">cumperc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">中小学</td>
<td align="right">2913</td>
<td align="right">0.5423571</td>
<td align="right">2913</td>
<td align="right">0.5423571</td>
</tr>
<tr class="even">
<td align="left">学校</td>
<td align="right">1831</td>
<td align="right">0.3409049</td>
<td align="right">4744</td>
<td align="right">0.8832620</td>
</tr>
<tr class="odd">
<td align="left">科教文化场所</td>
<td align="right">616</td>
<td align="right">0.1146900</td>
<td align="right">5360</td>
<td align="right">0.9979520</td>
</tr>
<tr class="even">
<td align="left">培训机构</td>
<td align="right">7</td>
<td align="right">0.0013033</td>
<td align="right">5367</td>
<td align="right">0.9992553</td>
</tr>
<tr class="odd">
<td align="left">科研机构</td>
<td align="right">1</td>
<td align="right">0.0001862</td>
<td align="right">5368</td>
<td align="right">0.9994414</td>
</tr>
<tr class="even">
<td align="left">运动场馆</td>
<td align="right">1</td>
<td align="right">0.0001862</td>
<td align="right">5369</td>
<td align="right">0.9996276</td>
</tr>
<tr class="odd">
<td align="left">风景名胜</td>
<td align="right">1</td>
<td align="right">0.0001862</td>
<td align="right">5370</td>
<td align="right">0.9998138</td>
</tr>
<tr class="even">
<td align="left">高尔夫相关</td>
<td align="right">1</td>
<td align="right">0.0001862</td>
<td align="right">5371</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
<ul>
<li>经过筛选的中小学数量支持针对本文的分析。</li>
</ul>
</div>
<div id="全域-2" class="section level4">
<h4>全域</h4>
<p>广佛全域中小学类设施的街镇分布情况：</p>
<pre class="r"><code>insc_ed_ag &lt;- setDT(insc_ed)[!is.na(name),][,.(cnt= length(name)),by = c(&quot;Name&quot;,&quot;layer1&quot;,&quot;layer2&quot;,&quot;cate&quot;)]

insc_ed_ag_1 &lt;- insc_ed_ag[cate == &quot;中小学&quot;,][,.(cnt= sum(cnt)),by = c(&quot;Name&quot;)]

gz_t_ed_1 &lt;- left_join(gz_t,insc_ed_ag_1,by =c(&quot;Name&quot;))
gz_t_ed_2 &lt;- setDT(gz_t_ed_1)[,pre_cnt := cnt/n7th*10000]
gz_t_ed_2 &lt;- st_as_sf(gz_t_ed_2)

ggplot()+ geom_sf(data = gz_t_ed_2,aes(fill= pre_cnt,geometry = geometry))+
  scale_fill_distiller(palette=&#39;Spectral&#39;)+
  geom_sf_text(data = gz_t_ed_2[gz_t_ed_2$pre_cnt &gt;= 2.5,],aes(label = Name),
               family=&#39;Songti SC&#39;,size = 2.5)+
  theme(text = element_text(family=&#39;Songti SC&#39;),         
        axis.title.x=element_blank(),          
        axis.title.y=element_blank())</code></pre>
<p><img src="/2022/10/17/guangfo-convenience-exploration-with-poi-data-2/index_files/figure-html/ed_tt-1.png" width="1000" /></p>
<ul>
<li>中小学的万人密度除了核心区域一如既往的高外，外周乡镇因为较低的人口基数，也有部分获得较高的人均密度。</li>
</ul>
</div>
<div id="核心区-2" class="section level4">
<h4>核心区</h4>
<p>核心城区的中小学类设施的分布情况：</p>
<pre class="r"><code>ggplot()+ geom_sf(data = gz_t_ed_2[gz_t_ed_2$core== T,],aes(fill= pre_cnt,geometry = geometry))+
  scale_fill_distiller(palette=&#39;Spectral&#39;)+
  geom_sf_text(data = gz_t_ed_2[gz_t_ed_2$core== T &amp; gz_t_ed_2$pre_cnt &gt;= 2,],aes(label = Name),
               family=&#39;Songti SC&#39;,size = 3)+
  theme(text = element_text(family=&#39;Songti SC&#39;),         
        axis.title.x=element_blank(),          
        axis.title.y=element_blank())</code></pre>
<p><img src="/2022/10/17/guangfo-convenience-exploration-with-poi-data-2/index_files/figure-html/ed_fc-1.png" width="1000" /></p>
</div>
</div>
<div id="政府服务机构" class="section level3">
<h3>政府服务机构</h3>
<pre class="r"><code>poi_sd &lt;- st_transform(poi_sd,4326)
poi_sd_fs &lt;- st_transform(poi_sd_fs,4326)

poi_sd &lt;- rbind(poi_sd[,c(&quot;cityname&quot;,&quot;lat&quot;,&quot;lon&quot;,&quot;name&quot;, &quot;address&quot; ,&quot;type1&quot;,&quot;type2&quot;,&quot;type3&quot;,&quot;geometry&quot;)],
                poi_sd_fs[,c(&quot;cityname&quot;,&quot;lat&quot;,&quot;lon&quot;,&quot;name&quot;, &quot;address&quot; ,&quot;type1&quot;,&quot;type2&quot;,&quot;type3&quot;,&quot;geometry&quot;)])

poi_sd &lt;- unique(poi_sd)
knitr::kable(head(Desc(poi_sd$type3)[[1]][[&quot;freq&quot;]],15))</code></pre>
<table>
<colgroup>
<col width="54%" />
<col width="6%" />
<col width="13%" />
<col width="11%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">level</th>
<th align="right">freq</th>
<th align="right">perc</th>
<th align="right">cumfreq</th>
<th align="right">cumperc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">政府机关相关</td>
<td align="right">4696</td>
<td align="right">0.3283227</td>
<td align="right">4696</td>
<td align="right">0.3283227</td>
</tr>
<tr class="even">
<td align="left">乡镇以下级政府及事业单位</td>
<td align="right">3799</td>
<td align="right">0.2656086</td>
<td align="right">8495</td>
<td align="right">0.5939313</td>
</tr>
<tr class="odd">
<td align="left">乡镇级政府及事业单位</td>
<td align="right">2326</td>
<td align="right">0.1626232</td>
<td align="right">10821</td>
<td align="right">0.7565546</td>
</tr>
<tr class="even">
<td align="left">区县级政府及事业单位</td>
<td align="right">1639</td>
<td align="right">0.1145913</td>
<td align="right">12460</td>
<td align="right">0.8711459</td>
</tr>
<tr class="odd">
<td align="left">地市级政府及事业单位</td>
<td align="right">407</td>
<td align="right">0.0284556</td>
<td align="right">12867</td>
<td align="right">0.8996015</td>
</tr>
<tr class="even">
<td align="left">政府及社会团体相关</td>
<td align="right">339</td>
<td align="right">0.0237013</td>
<td align="right">13206</td>
<td align="right">0.9233028</td>
</tr>
<tr class="odd">
<td align="left">省直辖市级政府及事业单位</td>
<td align="right">231</td>
<td align="right">0.0161505</td>
<td align="right">13437</td>
<td align="right">0.9394533</td>
</tr>
<tr class="even">
<td align="left">社会团体相关</td>
<td align="right">107</td>
<td align="right">0.0074809</td>
<td align="right">13544</td>
<td align="right">0.9469342</td>
</tr>
<tr class="odd">
<td align="left">外地政府办</td>
<td align="right">88</td>
<td align="right">0.0061526</td>
<td align="right">13632</td>
<td align="right">0.9530868</td>
</tr>
<tr class="even">
<td align="left">社会治安机构</td>
<td align="right">68</td>
<td align="right">0.0047542</td>
<td align="right">13700</td>
<td align="right">0.9578410</td>
</tr>
<tr class="odd">
<td align="left">生活服务场所</td>
<td align="right">34</td>
<td align="right">0.0023771</td>
<td align="right">13734</td>
<td align="right">0.9602181</td>
</tr>
<tr class="even">
<td align="left">乡镇级政府及事业单位|生活服务</td>
<td align="right">30</td>
<td align="right">0.0020975</td>
<td align="right">13764</td>
<td align="right">0.9623156</td>
</tr>
<tr class="odd">
<td align="left">公检法机关</td>
<td align="right">27</td>
<td align="right">0.0018877</td>
<td align="right">13791</td>
<td align="right">0.9642033</td>
</tr>
<tr class="even">
<td align="left">国家级机关及事业单位</td>
<td align="right">25</td>
<td align="right">0.0017479</td>
<td align="right">13816</td>
<td align="right">0.9659512</td>
</tr>
<tr class="odd">
<td align="left">乡镇以下级政府及事业单位|生活服务</td>
<td align="right">25</td>
<td align="right">0.0017479</td>
<td align="right">13841</td>
<td align="right">0.9676991</td>
</tr>
</tbody>
</table>
<div id="筛选" class="section level4">
<h4>筛选</h4>
<p>政府机构部分的思路则是从名字中筛选出与服务窗口相关的设施</p>
<pre class="r"><code>insc_sd &lt;- st_join(gz_t[,c(&quot;Name&quot;,&quot;layer1&quot;,&quot;layer2&quot;,&quot;geometry&quot;)],poi_sd)

insc_sd &lt;- setDT(insc_sd)[,cate:= type2 ]

##提取出政府机构中的窗口性设施

pat &lt;- &quot;服务|居委会|村民委员会|村委会|社区委员会|村务监督委员会|来访接待|信访&quot;
  insc_sd &lt;- insc_sd[grep(pat,name, perl = TRUE) ,cate:= &quot;服务机构&quot;]


knitr::kable(head(Desc(insc_sd$cate)[[1]][[&quot;freq&quot;]],15))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">level</th>
<th align="right">freq</th>
<th align="right">perc</th>
<th align="right">cumfreq</th>
<th align="right">cumperc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">政府机关</td>
<td align="right">9801</td>
<td align="right">0.6850493</td>
<td align="right">9801</td>
<td align="right">0.6850493</td>
</tr>
<tr class="even">
<td align="left">服务机构</td>
<td align="right">3741</td>
<td align="right">0.2614804</td>
<td align="right">13542</td>
<td align="right">0.9465297</td>
</tr>
<tr class="odd">
<td align="left">政府及社会团体相关</td>
<td align="right">297</td>
<td align="right">0.0207591</td>
<td align="right">13839</td>
<td align="right">0.9672887</td>
</tr>
<tr class="even">
<td align="left">社会团体</td>
<td align="right">142</td>
<td align="right">0.0099252</td>
<td align="right">13981</td>
<td align="right">0.9772140</td>
</tr>
<tr class="odd">
<td align="left">公检法机构</td>
<td align="right">141</td>
<td align="right">0.0098553</td>
<td align="right">14122</td>
<td align="right">0.9870693</td>
</tr>
<tr class="even">
<td align="left">交通车辆管理</td>
<td align="right">25</td>
<td align="right">0.0017474</td>
<td align="right">14147</td>
<td align="right">0.9888167</td>
</tr>
<tr class="odd">
<td align="left">公司企业</td>
<td align="right">16</td>
<td align="right">0.0011183</td>
<td align="right">14163</td>
<td align="right">0.9899350</td>
</tr>
<tr class="even">
<td align="left">生活服务场所</td>
<td align="right">16</td>
<td align="right">0.0011183</td>
<td align="right">14179</td>
<td align="right">0.9910533</td>
</tr>
<tr class="odd">
<td align="left">公司</td>
<td align="right">15</td>
<td align="right">0.0010484</td>
<td align="right">14194</td>
<td align="right">0.9921018</td>
</tr>
<tr class="even">
<td align="left">商务住宅相关</td>
<td align="right">12</td>
<td align="right">0.0008388</td>
<td align="right">14206</td>
<td align="right">0.9929405</td>
</tr>
<tr class="odd">
<td align="left">科教文化场所</td>
<td align="right">11</td>
<td align="right">0.0007689</td>
<td align="right">14217</td>
<td align="right">0.9937094</td>
</tr>
<tr class="even">
<td align="left">工商税务机构</td>
<td align="right">10</td>
<td align="right">0.0006990</td>
<td align="right">14227</td>
<td align="right">0.9944083</td>
</tr>
<tr class="odd">
<td align="left">临街院门</td>
<td align="right">9</td>
<td align="right">0.0006291</td>
<td align="right">14236</td>
<td align="right">0.9950374</td>
</tr>
<tr class="even">
<td align="left">医疗保健服务场所</td>
<td align="right">7</td>
<td align="right">0.0004893</td>
<td align="right">14243</td>
<td align="right">0.9955267</td>
</tr>
<tr class="odd">
<td align="left">楼宇</td>
<td align="right">5</td>
<td align="right">0.0003495</td>
<td align="right">14248</td>
<td align="right">0.9958761</td>
</tr>
</tbody>
</table>
</div>
<div id="全域-3" class="section level4">
<h4>全域</h4>
<pre class="r"><code>insc_sd_ag &lt;- setDT(insc_sd)[!is.na(name),][,cnt:= paste0(substr(lat,1,6),substr(lon,1,6),address)][,.(cnt= uniqueN(cnt)),by = c(&quot;Name&quot;,&quot;layer1&quot;,&quot;layer2&quot;,&quot;cate&quot;)]

insc_sd_ag_1 &lt;- insc_sd_ag[cate== &quot;服务机构&quot;,][,.(cnt= sum(cnt)),by = c(&quot;Name&quot;)]

gz_t_sd_1 &lt;- left_join(gz_t,insc_sd_ag_1,by =c(&quot;Name&quot;))
gz_t_sd_2 &lt;- setDT(gz_t_sd_1)[,pre_cnt := cnt/n7th*10000]
gz_t_sd_2 &lt;- st_as_sf(gz_t_sd_2)

ggplot()+ geom_sf(data = gz_t_sd_2,aes(fill= pre_cnt,geometry = geometry))+
  scale_fill_distiller(palette=&#39;Spectral&#39;)+
  geom_sf_text(data = gz_t_sd_2[gz_t_sd_2$pre_cnt &gt;= 5,],aes(label = Name),
               family=&#39;Songti SC&#39;,size = 2.5)+
  theme(text = element_text(family=&#39;Songti SC&#39;),         
        axis.title.x=element_blank(),          
        axis.title.y=element_blank())</code></pre>
<p><img src="/2022/10/17/guangfo-convenience-exploration-with-poi-data-2/index_files/figure-html/sd_tt-1.png" width="1000" /></p>
<ul>
<li>尽管与已经单独调整计算方式，但政府机构一个场所多个牌子的情况仍然很难排除，导致整体万人人均数量相对较高；</li>
<li>外周乡镇同样是整体人口规模较小，万人均值就相对较高；</li>
</ul>
</div>
<div id="核心区-3" class="section level4">
<h4>核心区</h4>
<p>核心城区的政府服务类设施的分布情况：</p>
<pre class="r"><code>ggplot()+ geom_sf(data = gz_t_sd_2[gz_t_sd_2$core== T,],aes(fill= pre_cnt,geometry = geometry))+
  scale_fill_distiller(palette=&#39;Spectral&#39;)+
  geom_sf_text(data = gz_t_sd_2[gz_t_sd_2$core== T &amp; gz_t_sd_2$pre_cnt &gt;= 3,],aes(label = Name),
               family=&#39;Songti SC&#39;,size = 3)+
  theme(text = element_text(family=&#39;Songti SC&#39;),         
        axis.title.x=element_blank(),          
        axis.title.y=element_blank())</code></pre>
<p><img src="/2022/10/17/guangfo-convenience-exploration-with-poi-data-2/index_files/figure-html/sd_fc-1.png" width="1000" /></p>
</div>
</div>
<div id="餐饮" class="section level3">
<h3>餐饮</h3>
<p>正如<a href="https://pauke.netlify.app/2022/10/14/guangfo-convenience-exploration-with-poi-data/">前文</a>所叙，本次获得的餐饮poi数据存在部分街道乡镇缺失的情况，故无法列示和纳入整体分析。</p>
<pre class="r"><code>poi_rs &lt;- st_transform(poi_rs,4326)
poi_rs_fs &lt;- st_transform(poi_rs_fs,4326)

poi_rs &lt;- rbind(poi_rs[,c(&quot;cityname&quot;,&quot;lat&quot;,&quot;lon&quot;,&quot;name&quot;, &quot;address&quot; ,&quot;type1&quot;,&quot;type2&quot;,&quot;type3&quot;,&quot;geometry&quot;)],
                poi_rs_fs[,c(&quot;cityname&quot;,&quot;lat&quot;,&quot;lon&quot;,&quot;name&quot;, &quot;address&quot; ,&quot;type1&quot;,&quot;type2&quot;,&quot;type3&quot;,&quot;geometry&quot;)])

ggplot()+ geom_sf(data = gz_t,aes(geometry = geometry))+
  geom_sf(data = poi_rs,aes(geometry = geometry),size = 0.5, color = &quot;red&quot;)</code></pre>
<p><img src="/2022/10/17/guangfo-convenience-exploration-with-poi-data-2/index_files/figure-html/rs-1.png" width="1000" /></p>
</div>
<div id="未完待续" class="section level2">
<h2>未完待续</h2>
<p>至此已经列示了本次参与分析的所有部分的所有poi数据情况，但本系列文章还会再针对如<a href="https://pauke.netlify.app/2022/10/14/guangfo-convenience-exploration-with-poi-data/">前文</a>结尾提到再做更新：</p>
<ul>
<li><a href="https://pauke.netlify.app/2022/10/18/guangfo-convenience-exploration-with-poi-data-3/"><strong>汇拢各个部分的结论，试着建设一个基于以上内容的指标模型</strong></a>。</li>
</ul>
</div>

    </div>
  </article>


  
  
  

 

  <div id=links>
    
      <a class="basic-alignment left" href="/2022/10/14/guangfo-convenience-exploration-with-poi-data/">&laquo; POI数据挖掘思路</a>
    
    
      <a class="basic-alignment left" href="/2022/10/18/guangfo-convenience-exploration-with-poi-data-3/">聚类模型构建 &raquo;</a>
    
  </div>
</section>



<script src="https://utteranc.es/client.js"
        repo="enersto/pauke.github.io"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>


<section id="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var d = document, s = d.createElement('script');
    s.src = '//pauke-netlify-app.disqus.com/embed.js'; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>



</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            <a href="/index.xml" type="application/rss+xml" target="_blank">RSS feed</a>
          </li>
          <li>
            <a href="https://gohugo.io/" class="footer-links-kudos">Made with <img src="/images/hugo-logo.png" alt="Img link to Hugo website" width="22" height="22"></a>
          </li>
        </ul>
      </footer>

    </div>
    



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



    
<script src="/js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-132686713-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
  </body>
</html>

